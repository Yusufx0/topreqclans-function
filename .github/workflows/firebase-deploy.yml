# Firebase Cloud Functions ve Hosting'i Dağıtmak için GitHub Actions İş Akışı

name: Deploy Cloud Functions and Hosting

on:
  push:
    branches:
      - main  # Ana branch'e (main) yapılan her push işlemini tetikle
  workflow_dispatch: # İsteğe bağlı olarak, GitHub arayüzünden manuel tetikleme sağlar

jobs:
  deploy:
    name: Firebase Dağıtımı
    runs-on: ubuntu-latest
    
    steps:
      - name: 1. Depoyu Çek (Checkout Repo)
        uses: actions/checkout@v4

      - name: 2. Node.js Kurulumu (Gerekli Sürüm)
        uses: actions/setup-node@v4
        with:
          node-version: '20' # <-- HATA GİDERİLDİ: Node.js 20.x'e yükseltildi

      - name: 3. Fonksiyon Bağımlılıklarını Kur (npm install)
        # functions klasörüne girer ve package.json içindeki bağımlılıkları yükler
        run: cd functions && npm install
        
      - name: 4. Firebase'e Dağıtma (Deploy)
        uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: '${{ secrets.GITHUB_TOKEN }}'
          firebaseServiceAccount: '${{ secrets.FIREBASE_SERVICE_ACCOUNT_JSON }}' 
          projectId: top-req-clans-63d88
          channelId: live 
